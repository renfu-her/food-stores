# Backend vs Shop Admin å°æ¯”èªªæ˜

> æœ¬æ–‡æª”èªªæ˜ `/backend` (Admin) å’Œ `/store_admin` (Store Admin) çš„è¨­è¨ˆå·®ç•°å’Œå¯¦ç¾æ–¹å¼

---

## ğŸ¯ è¨­è¨ˆç†å¿µ

### Backend (è¶…ç´šç®¡ç†å“¡)
- **å…¨å±€è¦–è§’** - ç®¡ç†æ•´å€‹ç³»çµ±
- **æ‰€æœ‰è³‡æº** - å¯æŸ¥çœ‹å’Œç·¨è¼¯æ‰€æœ‰åº—é‹ªã€ç”¢å“
- **ç³»çµ±è¨­å®š** - è¨‚å–®ç·¨è™Ÿã€éƒµä»¶è¨­å®š
- **å…§å®¹ç®¡ç†** - Bannerã€é—œæ–¼æˆ‘å€‘ã€æœ€æ–°æ¶ˆæ¯

### Shop Admin (åº—ä¸»)
- **åº—é‹ªè¦–è§’** - åªç®¡ç†è‡ªå·±çš„åº—é‹ª
- **è‡ªæœ‰è³‡æº** - åªèƒ½æŸ¥çœ‹å’Œç·¨è¼¯è‡ªå·±çš„åº—é‹ªã€ç”¢å“
- **ç°¡åŒ–åŠŸèƒ½** - ç§»é™¤é…æ–™ç®¡ç†ã€åº—é‹ªè¨­å®š
- **æ—¥å¸¸é‹ç‡Ÿ** - å°ˆæ³¨è¨‚å–®è™•ç†å’Œç”¢å“ç®¡ç†

---

## ğŸ“ é é¢çµæ§‹å°æ¯”

### å®Œå…¨ç›¸åŒçš„é é¢çµæ§‹

å…©è€…éƒ½æ¡ç”¨ **list.html + add.html + edit.html** ä¸‰é é¢çµæ§‹ï¼š

```
Backend                          Shop Admin
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/backend/shops                   /store_admin/shops
â”œâ”€â”€ list.html                    â”œâ”€â”€ list.html
â”œâ”€â”€ add.html                     â”œâ”€â”€ add.html
â””â”€â”€ edit.html                    â””â”€â”€ edit.html

/backend/products                /store_admin/products
â”œâ”€â”€ list.html                    â”œâ”€â”€ list.html
â”œâ”€â”€ add.html                     â”œâ”€â”€ add.html
â””â”€â”€ edit.html                    â””â”€â”€ edit.html
```

### å”¯ä¸€çš„æŠ€è¡“å·®ç•°

| é …ç›® | Backend | Shop Admin |
|------|---------|-----------|
| **æ¨¡æ¿ç¹¼æ‰¿** | `base/backend_base.html` | `base/shop_base.html` |
| **è·¯ç”±å‰ç¶´** | `url_for('backend.xxx')` | `url_for('store_admin.xxx')` |
| **æ¬Šé™éæ¿¾** | ç„¡ï¼ˆæŸ¥è©¢æ‰€æœ‰ï¼‰ | `filter_by(owner_id=user.id)` |

---

## ğŸ” åŠŸèƒ½å°æ¯”

### åº—é‹ªç®¡ç†

| åŠŸèƒ½ | Backend | Shop Admin | å·®ç•°èªªæ˜ |
|------|---------|-----------|---------|
| **åˆ—è¡¨é ** | âœ… æ‰€æœ‰åº—é‹ª | âœ… è‡ªå·±çš„åº—é‹ª | æ¬Šé™éæ¿¾ |
| **æ–°å¢é ** | âœ… éœ€é¸æ“‡åº—ä¸» â†“ | âœ… è‡ªå‹•ç‚ºç•¶å‰ç”¨æˆ¶ | ç°¡åŒ–æ¬„ä½ |
| **ç·¨è¼¯é ** | âœ… å®Œå…¨ç›¸åŒ | âœ… å®Œå…¨ç›¸åŒ | æ¬Šé™æª¢æŸ¥ |
| **ç¯©é¸åŠŸèƒ½** | â€¢ æœå°‹<br>â€¢ ç‹€æ…‹<br>â€¢ åº—ä¸» â†“ | â€¢ æœå°‹<br>â€¢ ç‹€æ…‹ | ç§»é™¤åº—ä¸»ç¯©é¸ |
| **æ“ä½œæŒ‰éˆ•** | â€¢ è©³æƒ…<br>â€¢ ç·¨è¼¯<br>â€¢ åˆªé™¤ | â€¢ ç·¨è¼¯<br>â€¢ åˆªé™¤ | ç§»é™¤è©³æƒ…æŒ‰éˆ• |
| **Banner ä¸Šå‚³** | âœ… | âœ… | å®Œå…¨ç›¸åŒ |
| **åœ–ç‰‡ç®¡ç†** | âœ… | âœ… | å®Œå…¨ç›¸åŒ |
| **é…æ–™è¨­ç½®** | âœ… | âœ… | å®Œå…¨ç›¸åŒ |

### ç”¢å“ç®¡ç†

| åŠŸèƒ½ | Backend | Shop Admin | å·®ç•°èªªæ˜ |
|------|---------|-----------|---------|
| **åˆ—è¡¨é ** | âœ… æ‰€æœ‰ç”¢å“ | âœ… è‡ªå·±åº—é‹ªçš„ç”¢å“ | æ¬Šé™éæ¿¾ |
| **æ–°å¢é ** | âœ… éœ€é¸æ“‡åº—é‹ª â†“ | âœ… è‡ªå‹•ç‚ºç•¶å‰åº—é‹ª | ç°¡åŒ–æ¬„ä½ |
| **ç·¨è¼¯é ** | âœ… å®Œå…¨ç›¸åŒ | âœ… å®Œå…¨ç›¸åŒ | æ¬Šé™æª¢æŸ¥ |
| **ç¯©é¸åŠŸèƒ½** | â€¢ æœå°‹<br>â€¢ åˆ†é¡<br>â€¢ åº—é‹ª â†“<br>â€¢ ç‹€æ…‹ | â€¢ æœå°‹<br>â€¢ åˆ†é¡<br>â€¢ ç‹€æ…‹ | ç§»é™¤åº—é‹ªç¯©é¸ |
| **é£²å“é¸é …** | âœ… | âœ… | å®Œå…¨ç›¸åŒ |
| **åœ–ç‰‡ä¸Šå‚³** | âœ… | âœ… | å®Œå…¨ç›¸åŒ |
| **é…æ–™é—œè¯** | âœ… | âœ… | å®Œå…¨ç›¸åŒ |

---

## ğŸ“Š å´é‚Šæ¬„å°èˆªå°æ¯”

```
Backend (Admin)              Shop Admin (åº—ä¸»)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”œâ”€â”€ å„€è¡¨æ¿                   â”œâ”€â”€ å„€è¡¨æ¿
â”œâ”€â”€ ç”¨æˆ¶ç®¡ç† â†“               â”‚
â”œâ”€â”€ åº—é‹ªç®¡ç†                 â”œâ”€â”€ åº—é‹ªç®¡ç†
â”œâ”€â”€ ç”¢å“ç®¡ç†                 â”œâ”€â”€ ç”¢å“ç®¡ç†
â”œâ”€â”€ è¨‚å–®ç®¡ç† â†“               â”œâ”€â”€ è¨‚å–®ç®¡ç†
â”œâ”€â”€ åˆ†é¡ç®¡ç† â†“               â”‚
â”œâ”€â”€ é¦–é ç®¡ç†                 â”‚
â”‚   â”œâ”€â”€ Banner ç®¡ç† â†“        â”‚
â”‚   â””â”€â”€ ...                  â”‚
â”œâ”€â”€ å…§å®¹ç®¡ç†                 â”‚
â”‚   â”œâ”€â”€ é—œæ–¼æˆ‘å€‘ â†“           â”‚
â”‚   â”œâ”€â”€ æœ€æ–°æ¶ˆæ¯ â†“           â”‚
â”‚   â””â”€â”€ ...                  â”‚
â””â”€â”€ ç³»çµ±è¨­å®š â†“               â””â”€â”€ çµ±è¨ˆ

åœ–ä¾‹ï¼š
  âœ“ = Backend å’Œ Shop Admin éƒ½æœ‰
  â†“ = åƒ… Backend æœ‰
```

---

## ğŸ” æ¬Šé™å¯¦ç¾å°æ¯”

### åº—é‹ªåˆ—è¡¨æŸ¥è©¢

**Backend (Admin):**
```python
def shops():
    shops = Shop.query.all()  # â† æŸ¥è©¢æ‰€æœ‰åº—é‹ª
    users = User.query.all()  # â† éœ€è¦é¡¯ç¤ºåº—ä¸»
    return render_template('backend/shops/list.html', 
                         shops=shops, 
                         users=users)
```

**Shop Admin (åº—ä¸»):**
```python
def shops():
    user = get_current_user()
    shops = Shop.query.filter_by(owner_id=user.id) \  # â† åªæŸ¥è©¢è‡ªå·±çš„
                      .filter(Shop.deleted_at.is_(None)) \
                      .all()
    return render_template('store_admin/shops/list.html', 
                         shops=shops, 
                         user=user)  # â† ç„¡éœ€ users åˆ—è¡¨
```

### ç”¢å“åˆ—è¡¨æŸ¥è©¢

**Backend (Admin):**
```python
def products():
    products = Product.query.all()  # â† æŸ¥è©¢æ‰€æœ‰ç”¢å“
    shops = Shop.query.all()        # â† éœ€è¦é¡¯ç¤ºåº—é‹ª
    categories = Category.query.all()
    return render_template('backend/products/list.html', ...)
```

**Shop Admin (åº—ä¸»):**
```python
def products():
    user = get_current_user()
    shop = Shop.query.filter_by(owner_id=user.id) \  # â† å…ˆç²å–åº—é‹ª
                     .filter(Shop.deleted_at.is_(None)) \
                     .first_or_404()
    products = Product.query.filter_by(shop_id=shop.id) \  # â† åªæŸ¥è©¢åº—é‹ªçš„ç”¢å“
                            .filter(Product.deleted_at.is_(None)) \
                            .all()
    categories = Category.query.all()
    return render_template('shop/products/list.html', 
                         products=products, 
                         shop=shop,  # â† å‚³éç•¶å‰åº—é‹ª
                         categories=categories)
```

### API æ¬Šé™æª¢æŸ¥

**Backend (Admin):**
```python
@products_api_bp.route('/<int:product_id>', methods='PUT'])
@role_required('admin')  # â† Admin å°ˆç”¨
def update_product(product_id):
    # ç„¡éœ€é¡å¤–æ¬Šé™æª¢æŸ¥
    product = Product.query.get_or_404(product_id)
    # ç›´æ¥æ›´æ–°...
```

**Shop Admin (åº—ä¸»):**
```python
@products_api_bp.route('/<int:product_id>', methods='PUT'])
@login_required  # â† ä»»ä½•ç™»å…¥ç”¨æˆ¶éƒ½å¯èª¿ç”¨
def update_product(product_id):
    user = get_current_user()
    product = Product.query.get_or_404(product_id)
    shop = Shop.query.get_or_404(product.shop_id)
    
    # âœ… æ¬Šé™æª¢æŸ¥ï¼šåªæœ‰ Admin æˆ–åº—é‹ªæ“æœ‰è€…å¯ä¿®æ”¹
    if user.role != 'admin' and shop.owner_id != user.id:
        return jsonify({'error': 'forbidden'}), 403
    
    # åŸ·è¡Œæ›´æ–°...
```

---

## ğŸ“ æ¨¡æ¿å·®ç•°è©³è§£

### shops/list.html

| å…ƒç´  | Backend | Shop Admin | å·®ç•° |
|------|---------|-----------|------|
| **æ¨¡æ¿ç¹¼æ‰¿** | `backend_base.html` | `shop_base.html` | âœ“ |
| **æ¨™é¡Œ** | åº—é‹ªç®¡ç† | æˆ‘çš„åº—é‹ª | âœ“ |
| **æ–°å¢æŒ‰éˆ•** | `backend.shop_add` | `store_admin.shop_add` | âœ“ |
| **åº—ä¸»ç¯©é¸** | âœ… æœ‰ | âŒ ç„¡ | âœ“ |
| **è¡¨æ ¼æ¬„ä½** | ID, åç¨±, åº—ä¸», é…æ–™, ç‹€æ…‹, æ™‚é–“ | ID, åç¨±, è¨‚å–®ID, é…æ–™, ç‹€æ…‹, æ™‚é–“ | âœ“ |
| **æ“ä½œæŒ‰éˆ•** | è©³æƒ…, ç·¨è¼¯, åˆªé™¤ | ç·¨è¼¯, åˆªé™¤ | âœ“ |
| **åˆ†é ** | âœ… | âœ… | âœ“ |

### shops/add.html

| å…ƒç´  | Backend | Shop Admin | å·®ç•° |
|------|---------|-----------|------|
| **æ¨¡æ¿ç¹¼æ‰¿** | `backend_base.html` | `shop_base.html` | âœ“ |
| **è¿”å›æŒ‰éˆ•** | `backend.shops` | `store_admin.shops` | âœ“ |
| **é¸æ“‡åº—ä¸»** | âœ… å¿…å¡«æ¬„ä½ | âŒ è‡ªå‹•ç‚ºç•¶å‰ç”¨æˆ¶ | âœ“ |
| **å•†åº—è¨‚å–®ID** | âœ… | âœ… | âœ“ |
| **é…æ–™è¨­ç½®** | âœ… | âœ… | âœ“ |
| **API ç«¯é»** | `/api/shops` | `/api/shops` | ç›¸åŒ |
| **owner_id** | å¾è¡¨å–®å–å¾— | ç”± API è‡ªå‹•è¨­ç½® | âœ“ |

### products/add.html

| å…ƒç´  | Backend | Shop Admin | å·®ç•° |
|------|---------|-----------|------|
| **é¸æ“‡åº—é‹ª** | âœ… å¿…å¡«æ¬„ä½ | âŒ è‡ªå‹•ç‚ºç•¶å‰åº—é‹ª | âœ“ |
| **shop_id** | å¾è¡¨å–®å–å¾— | å¾æ¨¡æ¿è®Šæ•¸ `{{ shop.id }}` | âœ“ |
| **é£²å“é¸é …** | âœ… | âœ… | ç›¸åŒ |
| **åˆ†é¡ç®¡ç†é€£çµ** | âœ… é½’è¼ªæŒ‰éˆ• | âŒ ç„¡ | âœ“ |

---

## ğŸ”‘ shop_id å’Œ owner_id è™•ç†

### æ–°å¢åº—é‹ª

**Backend submit:**
```javascript
const data = {
    name: '...',
    owner_id: parseInt($('#shopOwner').val()),  // â† å¾è¡¨å–®
    description: '...',
    ...
};
```

**Shop Admin submit:**
```javascript
const data = {
    name: '...',
    // owner_id ç”± API è‡ªå‹•è¨­ç½®ç‚º current_user.id
    description: '...',
    ...
};
```

**APIè™•ç†:**
```python
@shops_api_bp.route('', methods=['POST'])
@login_required
def create_shop():
    data = request.get_json()
    user = get_current_user()
    
    # Backend: ä½¿ç”¨æäº¤çš„ owner_id
    if user.role == 'admin' and 'owner_id' in data:
        owner_id = data['owner_id']
    else:
        # Shop Admin: è‡ªå‹•ä½¿ç”¨ç•¶å‰ç”¨æˆ¶
        owner_id = user.id
    
    shop = Shop(
        name=data['name'],
        owner_id=owner_id,  # â† æ ¹æ“šè§’è‰²æ±ºå®š
        ...
    )
```

### æ–°å¢ç”¢å“

**Backend submit:**
```javascript
const data = {
    name: '...',
    shop_id: parseInt($('#productShop').val()),  // â† å¾ä¸‹æ‹‰é¸å–®
    category_id: parseInt($('#productCategory').val()),
    ...
};
```

**Shop Admin submit:**
```javascript
const data = {
    name: '...',
    shop_id: {{ shop.id }},  // â† ç›´æ¥å¾æ¨¡æ¿è®Šæ•¸
    category_id: parseInt($('#productCategory').val()),
    ...
};
```

---

## ğŸ¨ UI/UX å·®ç•°

### åˆ—è¡¨é è¡¨æ ¼æ¬„ä½

**åº—é‹ªåˆ—è¡¨:**
```
Backend:     ID | åº—é‹ªåç¨± | åº—ä¸»    | æœ€å¤§é…æ–™ | ç‹€æ…‹ | æ™‚é–“ | æ“ä½œ
Shop Admin:  ID | åº—é‹ªåç¨± | è¨‚å–®ID  | æœ€å¤§é…æ–™ | ç‹€æ…‹ | æ™‚é–“ | æ“ä½œ
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å·®ç•°ï¼š                        â†‘ æ”¹ç‚ºé¡¯ç¤ºè¨‚å–®IDï¼ˆæ›´å¯¦ç”¨ï¼‰
```

**ç”¢å“åˆ—è¡¨:**
```
Backend:     ID | ç”¢å“åç¨± | åº—é‹ª | åˆ†é¡ | å–®åƒ¹ | åº«å­˜ | ç‹€æ…‹ | æ“ä½œ
Shop Admin:  ID | ç”¢å“åç¨± | åˆ†é¡ | å–®åƒ¹ | æŠ˜æ‰£ | åº«å­˜ | é£²å“ | ç‹€æ…‹ | æ“ä½œ
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å·®ç•°ï¼š                        â†‘ ç§»é™¤åº—é‹ªæ¬„ä½ï¼ˆå·²çŸ¥æ˜¯è‡ªå·±çš„åº—é‹ªï¼‰
                                   â†‘ å¢åŠ æŠ˜æ‰£åƒ¹å’Œé£²å“åœ–æ¨™
```

### æ–°å¢é è¡¨å–®æ¬„ä½

**åº—é‹ªæ–°å¢:**
```
Backend:                     Shop Admin:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ åº—é‹ªåç¨± *                 â€¢ åº—é‹ªåç¨± *
â€¢ åº—ä¸» * â†“                   â€¢ å•†åº—è¨‚å–®ID *
â€¢ åº—é‹ªæè¿°                   â€¢ åº—é‹ªæè¿°
â€¢ å•†åº—è¨‚å–®ID *               â€¢ æœ€å¤§é…æ–™æ•¸é‡ *
â€¢ æœ€å¤§é…æ–™æ•¸é‡ *             â€¢ ç‹€æ…‹
â€¢ åˆå§‹é…æ–™                   â€¢ åˆå§‹é…æ–™

å·®ç•°ï¼šç§»é™¤ã€Œé¸æ“‡åº—ä¸»ã€æ¬„ä½ï¼Œèª¿æ•´é †åº
```

**ç”¢å“æ–°å¢:**
```
Backend:                     Shop Admin:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ ç”¢å“åç¨± *                 â€¢ ç”¢å“åç¨± *
â€¢ æ‰€å±¬åº—é‹ª * â†“               â€¢ ç”¢å“åˆ†é¡ *
â€¢ ç”¢å“åˆ†é¡ *                 â€¢ ç”¢å“æè¿°
â€¢ ç”¢å“æè¿°                   â€¢ å–®åƒ¹ *
â€¢ å–®åƒ¹ *                     â€¢ æŠ˜æ‰£åƒ¹
â€¢ æŠ˜æ‰£åƒ¹                     â€¢ åº«å­˜æ•¸é‡ *
â€¢ åº«å­˜æ•¸é‡ *                 â€¢ ç‹€æ…‹ *
â€¢ ç‹€æ…‹ *                     â€¢ é£²å“é¸é …
â€¢ é£²å“é¸é …

å·®ç•°ï¼šç§»é™¤ã€Œæ‰€å±¬åº—é‹ªã€ä¸‹æ‹‰é¸å–®
```

---

## ğŸ”„ æ•¸æ“šæµå°æ¯”

### Backend æ–°å¢åº—é‹ªæµç¨‹

```
1. Admin ç™»å…¥ /backend
   â†“
2. é»æ“Šã€Œåº—é‹ªç®¡ç†ã€
   â†“
3. é»æ“Šã€Œæ–°å¢åº—é‹ªã€
   â†“
4. å¡«å¯«è¡¨å–®ï¼š
   - åº—é‹ªåç¨±
   - ã€é¸æ“‡åº—ä¸»ã€‘â† å¾ä¸‹æ‹‰é¸å–®
   - å•†åº—è¨‚å–®ID
   - ...
   â†“
5. æäº¤ï¼šPOST /api/shops
   {
     "owner_id": é¸ä¸­çš„ç”¨æˆ¶ID
   }
   â†“
6. åº—é‹ªå‰µå»ºï¼Œowner_id = è¡¨å–®é¸æ“‡çš„å€¼
```

### Shop Admin æ–°å¢åº—é‹ªæµç¨‹

```
1. åº—ä¸»ç™»å…¥ /store_admin
   â†“
2. é»æ“Šã€Œåº—é‹ªç®¡ç†ã€
   â†“
3. é»æ“Šã€Œæ–°å¢åº—é‹ªã€
   â†“
4. å¡«å¯«è¡¨å–®ï¼š
   - åº—é‹ªåç¨±
   - ã€ç„¡éœ€é¸æ“‡åº—ä¸»ã€‘â† è‡ªå‹•ç‚ºç•¶å‰ç”¨æˆ¶
   - å•†åº—è¨‚å–®ID
   - ...
   â†“
5. æäº¤ï¼šPOST /api/shops
   {
     // owner_id ç”± API è‡ªå‹•è¨­ç½®
   }
   â†“
6. åº—é‹ªå‰µå»ºï¼Œowner_id = current_user.id
```

---

## ğŸ›¡ï¸ å®‰å…¨æ€§å°æ¯”

### Backend

```python
# æ¬Šé™æª¢æŸ¥è¼ƒå¯¬é¬†ï¼ˆå› ç‚º Admin å¯ä»¥ç®¡ç†ä¸€åˆ‡ï¼‰
@backend_bp.route('/shops')
@role_required('admin')  # â† åªæª¢æŸ¥æ˜¯å¦ç‚º Admin
def shops():
    shops = Shop.query.all()  # â† ç„¡éæ¿¾
    return render_template(...)
```

### Shop Admin

```python
# æ¬Šé™æª¢æŸ¥åš´æ ¼ï¼ˆåªèƒ½è¨ªå•è‡ªå·±çš„è³‡æºï¼‰
@store_admin_bp.route('/shops')
@role_required('store_admin')  # â† æª¢æŸ¥è§’è‰²
def shops():
    user = get_current_user()
    # âœ… é›™é‡éæ¿¾
    shops = Shop.query.filter_by(owner_id=user.id) \     # 1. owner éæ¿¾
                      .filter(Shop.deleted_at.is_(None)) \  # 2. è»Ÿåˆªé™¤éæ¿¾
                      .all()
    return render_template(...)
```

**API å±¤ç´šä¹Ÿæœ‰é›™é‡æª¢æŸ¥ï¼š**
```python
# è·¯ç”±å·²æœ‰ @role_required('store_admin')
# API å…§éƒ¨é‚„æœƒæª¢æŸ¥ owner_id
if user.role != 'admin' and shop.owner_id != user.id:
    return jsonify({'error': 'forbidden'}), 403
```

---

## ğŸ“‹ å¯¦ç¾æ¸…å–®

### âœ… å·²å¯¦ç¾

**é é¢çµæ§‹ï¼š**
- [x] Shop Admin å®Œå…¨è¤‡è£½ Backend çš„ shops ä¸‰é é¢
- [x] Shop Admin å®Œå…¨è¤‡è£½ Backend çš„ products ä¸‰é é¢
- [x] ä¿®æ”¹æ¨¡æ¿ç¹¼æ‰¿ç‚º `shop_base.html`
- [x] ä¿®æ”¹æ‰€æœ‰ `url_for('backend.xxx')` ç‚º `store_admin.xxx`

**åŠŸèƒ½ç°¡åŒ–ï¼š**
- [x] ç§»é™¤ã€Œé¸æ“‡åº—ä¸»ã€æ¬„ä½ï¼ˆæ–°å¢åº—é‹ªæ™‚ï¼‰
- [x] ç§»é™¤ã€Œé¸æ“‡åº—é‹ªã€æ¬„ä½ï¼ˆæ–°å¢ç”¢å“æ™‚ï¼‰
- [x] ç§»é™¤ã€Œåº—ä¸»ç¯©é¸ã€ï¼ˆåº—é‹ªåˆ—è¡¨ï¼‰
- [x] ç§»é™¤ã€Œåº—é‹ªç¯©é¸ã€ï¼ˆç”¢å“åˆ—è¡¨ï¼‰
- [x] ç§»é™¤ã€Œåº—é‹ªè¨­å®šã€åŠŸèƒ½
- [x] ç§»é™¤ã€Œé…æ–™ç®¡ç†ã€åŠŸèƒ½
- [x] ç§»é™¤ã€Œè©³æƒ…ã€æŒ‰éˆ•ï¼ˆåº—é‹ªåˆ—è¡¨ï¼‰

**æ¬Šé™æ§åˆ¶ï¼š**
- [x] æ‰€æœ‰æŸ¥è©¢æ·»åŠ  `filter_by(owner_id=user.id)`
- [x] æ‰€æœ‰æŸ¥è©¢æ·»åŠ  `filter(deleted_at.is_(None))`
- [x] API å±¤ç´šæª¢æŸ¥ `owner_id` åŒ¹é…

### âŒ åŠŸèƒ½å·®ç•°

| åŠŸèƒ½ | Backend | Shop Admin | åŸå›  |
|------|---------|-----------|------|
| ç”¨æˆ¶ç®¡ç† | âœ… | âŒ | éåº—ä¸»è·è²¬ |
| åˆ†é¡ç®¡ç† | âœ… | âŒ | å…¨å±€è¨­å®š |
| é¦–é ç®¡ç† | âœ… | âŒ | å…¨å±€å…§å®¹ |
| å…§å®¹ç®¡ç† | âœ… | âŒ | å…¨å±€å…§å®¹ |
| ç³»çµ±è¨­å®š | âœ… | âŒ | å…¨å±€è¨­å®š |
| é…æ–™ç®¡ç† | âœ… | âŒ | ç°¡åŒ–æµç¨‹ |
| åº—é‹ªè¨­å®š | âœ… | âŒ | åˆä½µåˆ°åº—é‹ªç®¡ç† |

---

## ğŸ¯ ç¸½çµ

### æ ¸å¿ƒåŸå‰‡

1. **åŠŸèƒ½å°é½Š** - Shop Admin çš„åº—é‹ªå’Œç”¢å“ç®¡ç†èˆ‡ Backend å®Œå…¨ç›¸åŒ
2. **æ¬Šé™éš”é›¢** - é€šé `owner_id` å’Œ `shop_id` éæ¿¾å¯¦ç¾æ•¸æ“šéš”é›¢
3. **ç°¡åŒ–æ“ä½œ** - ç§»é™¤é¸æ“‡åº—ä¸»/åº—é‹ªçš„æ¬„ä½ï¼Œè‡ªå‹•ä½¿ç”¨ç•¶å‰ä¸Šä¸‹æ–‡
4. **ç²¾ç°¡åŠŸèƒ½** - ç§»é™¤ä¸å¿…è¦çš„é…æ–™ç®¡ç†å’Œåº—é‹ªè¨­å®š

### é—œéµå·®ç•°

```
Backend = å…¨å±€ç®¡ç†ï¼ˆæ‰€æœ‰è³‡æºï¼‰
Shop Admin = è‡ªæœ‰ç®¡ç†ï¼ˆowner_id éæ¿¾ï¼‰

ç›¸åŒè¨­è¨ˆ + æ¬Šé™éæ¿¾ = æ•¸æ“šéš”é›¢
```

### å¯¦ç¾æ–¹å¼

1. è¤‡è£½ Backend çš„å®Œæ•´é é¢
2. æ›¿æ›æ¨¡æ¿ç¹¼æ‰¿å’Œè·¯ç”±å¼•ç”¨
3. ç§»é™¤ä¸é©ç”¨çš„ç¯©é¸å™¨å’Œæ¬„ä½
4. è·¯ç”±å±¤ç´šæ·»åŠ æ¬Šé™éæ¿¾
5. API å±¤ç´šæ·»åŠ æ¬Šé™æª¢æŸ¥

---

<div align="center">
  <p>ğŸ¨ ç›¸åŒçš„è¨­è¨ˆ Â· ğŸ” éš”é›¢çš„æ¬Šé™</p>
  <p>ğŸ’¼ Backend è¨­è¨ˆ Â· ğŸª Shop Admin å¾©ç”¨</p>
</div>

