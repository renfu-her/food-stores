# 測試清單 - Shop Admin vs Backend

> 驗證 `/shop` 和 `/backend` 功能是否一致

---

## ✅ 店鋪管理測試

### 1. 店鋪列表頁（/shop/shops）

- [ ] 訪問 `/shop/shops` 能正常顯示
- [ ] 列表顯示當前用戶擁有的店鋪
- [ ] 搜尋功能正常（名稱、描述）
- [ ] 狀態篩選正常（營業中/已關閉）
- [ ] 分頁功能正常
- [ ] 「新增店鋪」按鈕正常跳轉
- [ ] 「編輯」按鈕正常跳轉
- [ ] 「刪除」按鈕執行軟刪除
- [ ] 表格欄位：ID, 店鋪名稱, 訂單ID, 最大配料, 狀態, 建立時間, 操作
- [ ] ❌ 無「店主篩選」（與 Backend 差異）

### 2. 新增店鋪頁（/shop/shops/add）

- [ ] 頁面正常顯示
- [ ] 「返回」按鈕跳轉到列表頁
- [ ] 必填欄位：店鋪名稱、商店訂單ID、最大配料數量
- [ ] ❌ 無「選擇店主」欄位（與 Backend 差異）
- [ ] 商店訂單ID 自動轉大寫
- [ ] 商店訂單ID 驗證（2-20字符，A-Z0-9）
- [ ] 商店訂單ID 唯一性驗證
- [ ] 初始配料設置正常（添加/移除行）
- [ ] 提交成功後跳轉到列表頁
- [ ] 錯誤提示正常顯示
- [ ] shop.owner_id 自動設為當前用戶

### 3. 編輯店鋪頁（/shop/shops/<id>/edit）

- [ ] 頁面正常顯示
- [ ] 表單預填現有數據
- [ ] 基本資訊更新正常
- [ ] 商店訂單ID 修改正常（驗證唯一性）
- [ ] Banner 上傳功能正常
- [ ] Banner 刪除功能正常
- [ ] 店鋪圖片上傳正常（多張，可排序）
- [ ] 店鋪圖片刪除正常
- [ ] SortableJS 拖曳排序正常
- [ ] 配料列表顯示正常
- [ ] 配料新增/編輯/刪除正常
- [ ] 「刪除店鋪」按鈕執行軟刪除
- [ ] 更新成功後跳轉到列表頁
- [ ] 權限檢查：只能編輯 owner_id = user.id 的店鋪

---

## ✅ 產品管理測試

### 4. 產品列表頁（/shop/products）

- [ ] 訪問 `/shop/products` 能正常顯示
- [ ] 列表顯示當前店鋪的產品
- [ ] 搜尋功能正常（產品名稱、描述）
- [ ] 分類篩選正常
- [ ] 狀態篩選正常（已上架/已下架）
- [ ] ❌ 無「店鋪篩選」（與 Backend 差異）
- [ ] 分頁功能正常
- [ ] 「新增產品」按鈕正常跳轉
- [ ] 「編輯」按鈕正常跳轉
- [ ] 「刪除」按鈕執行軟刪除
- [ ] 「上下架」按鈕切換狀態
- [ ] 表格欄位：ID, 產品名稱, 分類, 單價, 折扣價, 庫存, 飲品圖標, 狀態, 操作
- [ ] 飲品圖標正確顯示（🧊 冷飲, ☕ 熱飲）

### 5. 新增產品頁（/shop/products/add）

- [ ] 頁面正常顯示
- [ ] 「返回」按鈕跳轉到列表頁
- [ ] 必填欄位：產品名稱、分類、單價、庫存、狀態
- [ ] ❌ 無「選擇店鋪」欄位（與 Backend 差異）
- [ ] 產品分類下拉正常
- [ ] ❌ 無「管理分類」齒輪按鈕（與 Backend 差異）
- [ ] 單價和折扣價驗證（折扣價 < 單價）
- [ ] 飲品選項設置：
  - [ ] 勾選「提供冷飲」顯示加價輸入框
  - [ ] 勾選「提供熱飲」顯示加價輸入框
  - [ ] 取消勾選隱藏加價輸入框
  - [ ] 加價可設為 0
- [ ] 提交成功後跳轉到列表頁
- [ ] 錯誤提示正常顯示
- [ ] product.shop_id 自動設為當前店鋪

### 6. 編輯產品頁（/shop/products/<id>/edit）

- [ ] 頁面正常顯示
- [ ] 表單預填現有數據
- [ ] 基本資訊更新正常
- [ ] 飲品選項預填正常（勾選狀態和價格）
- [ ] 飲品選項修改正常
- [ ] 產品圖片上傳正常（多張，可排序）
- [ ] 產品圖片刪除正常
- [ ] SortableJS 拖曳排序正常
- [ ] 配料關聯管理正常（從店鋪配料列表選擇）
- [ ] 「刪除產品」按鈕執行軟刪除
- [ ] 更新成功後跳轉到列表頁
- [ ] 權限檢查：只能編輯 shop_id 屬於自己店鋪的產品

---

## ✅ 權限隔離測試

### 7. 數據隔離

**準備工作：**
```bash
# 創建兩個店主帳號
python test_permissions.py
# 店主 A: owner_a@test.com / Test123@
# 店主 B: owner_b@test.com / Test123@
```

**測試步驟：**

- [ ] **店主 A 登入**
  - [ ] 店鋪列表只顯示店鋪 A
  - [ ] 產品列表只顯示店鋪 A 的產品
  - [ ] 無法訪問 `/shop/shops/<shop_b_id>/edit`（404）
  - [ ] API 無法修改店鋪 B：`PUT /api/shops/<shop_b_id>` 返回 403
  - [ ] API 無法修改產品 B：`PUT /api/products/<product_b_id>` 返回 403

- [ ] **店主 B 登入**
  - [ ] 店鋪列表只顯示店鋪 B
  - [ ] 產品列表只顯示店鋪 B 的產品
  - [ ] 無法訪問店主 A 的資源

- [ ] **Admin 登入**
  - [ ] Backend 可以看到所有店鋪（A + B）
  - [ ] Backend 可以編輯任何店鋪和產品

### 8. 軟刪除測試

- [ ] **刪除店鋪：**
  - [ ] 點擊「刪除」按鈕
  - [ ] 確認對話框顯示「軟刪除」提示
  - [ ] 刪除後從列表消失
  - [ ] 數據庫 `deleted_at` 有值
  - [ ] 前台不再顯示該店鋪
  - [ ] Admin 後台可查看並恢復

- [ ] **刪除產品：**
  - [ ] 點擊「刪除」按鈕
  - [ ] 刪除後從列表消失
  - [ ] 數據庫 `deleted_at` 有值
  - [ ] `is_active` 設為 false
  - [ ] 前台不再顯示該產品

---

## ✅ UI/UX 一致性測試

### 9. 與 Backend 對比

- [ ] **頁面佈局** - Shop Admin 和 Backend 完全相同
- [ ] **表格樣式** - 相同的 Bootstrap 樣式
- [ ] **按鈕樣式** - 相同的顏色和圖標
- [ ] **表單佈局** - 相同的 8欄/4欄 分割
- [ ] **錯誤提示** - 相同的紅色 Alert
- [ ] **成功提示** - 相同的綠色 Alert

### 10. 飲品功能測試

- [ ] **新增產品時：**
  - [ ] 勾選「提供冷飲」，加價輸入框出現
  - [ ] 勾選「提供熱飲」，加價輸入框出現
  - [ ] 取消勾選，加價輸入框消失
  - [ ] 加價可設為 0

- [ ] **編輯產品時：**
  - [ ] 如果已有冷飲，勾選框自動勾選
  - [ ] 加價自動填入
  - [ ] 修改加價正常儲存

- [ ] **列表顯示：**
  - [ ] 有冷飲顯示 🧊 圖標
  - [ ] 有熱飲顯示 ☕ 圖標
  - [ ] 無飲品顯示 `-`

- [ ] **前台顧客：**
  - [ ] 商品詳情顯示飲品選擇
  - [ ] 選擇冷飲，總價正確計算
  - [ ] 選擇熱飲，總價正確計算
  - [ ] 購物車顯示飲品選項
  - [ ] 訂單詳情顯示飲品資訊

---

## 🔧 功能完整性測試

### 11. 完整業務流程

**流程：新店鋪 → 新產品 → 顧客下單 → 訂單處理**

- [ ] **Step 1: 店主新增店鋪**
  - [ ] 填寫店鋪資訊
  - [ ] 設置配料（可選）
  - [ ] 儲存成功

- [ ] **Step 2: 店主新增產品**
  - [ ] 填寫產品資訊
  - [ ] 設置飲品選項（冷飲 +$10, 熱飲 +$5）
  - [ ] 上傳產品圖片
  - [ ] 儲存成功

- [ ] **Step 3: 顧客瀏覽和下單**
  - [ ] 前台可以看到店鋪
  - [ ] 前台可以看到產品
  - [ ] 商品詳情顯示飲品選擇
  - [ ] 選擇冷飲，加入購物車
  - [ ] 結帳下單

- [ ] **Step 4: 店主接收訂單**
  - [ ] 🔔 鈴鐺紅點出現
  - [ ] 播放提示音
  - [ ] 頂部橫幅通知
  - [ ] 訂單管理頁面顯示訂單
  - [ ] 訂單詳情顯示飲品資訊（🧊 冷飲）
  - [ ] 更新訂單狀態正常

---

## 📊 測試結果記錄

### 執行測試

```bash
# 1. 啟動應用
python app.py

# 2. 登入店主帳號
http://localhost:5000/shop
Email: store1@store.com
密碼: Qq123456@

# 3. 依序測試各功能

# 4. 記錄問題
如有問題，請在下方記錄：
```

### 問題記錄

| # | 功能 | 問題描述 | 狀態 |
|---|------|---------|------|
| 1 |  |  |  |
| 2 |  |  |  |
| 3 |  |  |  |

---

## 🎯 預期結果

### 成功標準

✅ **頁面一致性**
- Shop Admin 的店鋪管理和產品管理頁面與 Backend 完全相同
- 除了模板繼承和路由引用外，HTML 結構相同

✅ **功能一致性**
- 所有 Backend 的功能在 Shop Admin 都正常工作
- 飲品選項設置和顯示正常
- Banner 和圖片上傳正常
- 配料管理（在 edit 頁面）正常

✅ **權限隔離**
- 店主只能看到自己的店鋪和產品
- 無法訪問其他店主的資源
- API 返回 403 Forbidden

✅ **軟刪除**
- 刪除操作設置 deleted_at
- 刪除後從列表消失
- 數據保留在資料庫
- Admin 可以恢復

---

## 📝 測試報告模板

```
測試日期：2025-11-06
測試人員：_____________
測試環境：Development

【店鋪管理】
✓ 列表頁：通過
✓ 新增頁：通過
✓ 編輯頁：通過
問題：無

【產品管理】
✓ 列表頁：通過
✓ 新增頁：通過（飲品選項正常）
✓ 編輯頁：通過（圖片上傳正常）
問題：無

【權限隔離】
✓ 數據隔離：通過
✓ API 權限：通過
問題：無

【軟刪除】
✓ 店鋪軟刪除：通過
✓ 產品軟刪除：通過
問題：無

總結：
所有功能測試通過，Shop Admin 與 Backend 功能完全對齊。
```

---

<div align="center">
  <p>✅ 測試完成後請更新本文檔</p>
  <p>📊 記錄測試結果以便追蹤</p>
</div>

