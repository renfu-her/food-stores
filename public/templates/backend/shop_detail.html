{% extends "base/backend_base.html" %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>店鋪詳情</h1>
        <a href="{{ url_for('backend.shops') }}" class="btn btn-secondary">返回列表</a>
    </div>
    
    <div class="detail-card">
        <div class="detail-header">
            <h2>{{ shop.name }}</h2>
            <span class="badge {% if shop.status == 'active' %}badge-success{% else %}badge-danger{% endif %}">
                {% if shop.status == 'active' %}啟動{% else %}禁用{% endif %}
            </span>
        </div>
        
        <div class="detail-body">
            <div class="info-section">
                <h3>基本資訊</h3>
                <div class="info-item">
                    <label>店鋪ID:</label>
                    <span>{{ shop.id }}</span>
                </div>
                <div class="info-item">
                    <label>店鋪名稱:</label>
                    <span>{{ shop.name }}</span>
                </div>
                <div class="info-item">
                    <label>擁有者:</label>
                    <span>{{ shop.owner.name if shop.owner else 'N/A' }} ({{ shop.owner.email if shop.owner else 'N/A' }})</span>
                </div>
                <div class="info-item">
                    <label>描述:</label>
                    <span>{{ shop.description or '暫無描述' }}</span>
                </div>
                <div class="info-item">
                    <label>最大Toppings數量:</label>
                    <span>{{ shop.max_toppings_per_order }}</span>
                </div>
                <div class="info-item">
                    <label>建立時間:</label>
                    <span>{{ shop.created_at.strftime('%Y-%m-%d %H:%M') if shop.created_at else '' }}</span>
                </div>
            </div>
            
            <div class="products-section">
                <h3>產品列表 ({{ products|length }})</h3>
                {% if products %}
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>產品名稱</th>
                                <th>分類</th>
                                <th>單價</th>
                                <th>庫存</th>
                                <th>狀態</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for product in products %}
                            <tr>
                                <td>{{ product.id }}</td>
                                <td>{{ product.name }}</td>
                                <td>{{ product.category.name if product.category else 'N/A' }}</td>
                                <td>${{ product.unit_price|int }}</td>
                                <td>{{ product.stock_quantity }}</td>
                                <td>
                                    {% if product.is_active %}
                                        <span class="badge badge-success">上架</span>
                                    {% else %}
                                        <span class="badge badge-danger">下架</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <a href="{{ url_for('backend.product_detail', product_id=product.id) }}" class="btn btn-sm btn-primary">查看</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p>此店鋪暫無產品</p>
                {% endif %}
            </div>
            
            <div class="toppings-section">
                <h3>Toppings列表 ({{ toppings|length }})</h3>
                {% if toppings %}
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>名稱</th>
                                <th>價格</th>
                                <th>狀態</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for topping in toppings %}
                            <tr>
                                <td>{{ topping.id }}</td>
                                <td>{{ topping.name }}</td>
                                <td>
                                    {% if topping.price == 0 %}
                                        <span class="free-badge">FREE</span>
                                    {% else %}
                                        ${{ topping.price|int }}
                                    {% endif %}
                                </td>
                                <td>
                                    {% if topping.is_active %}
                                        <span class="badge badge-success">啟動</span>
                                    {% else %}
                                        <span class="badge badge-danger">禁用</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p>此店鋪暫無Toppings</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

