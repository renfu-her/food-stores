{% extends "base/app.html" %}

{% block title %}訪客點餐 - Quick Foods{% endblock %}

{% block nav_menu %}
    {% if shop %}
    <li class="nav-item">
        <span class="nav-link text-white">
            <i class="bi bi-shop me-1"></i>{{ shop.name }}
        </span>
    </li>
    {% endif %}
    {% if table_number %}
    <li class="nav-item">
        <span class="nav-link text-warning fw-bold">
            <i class="bi bi-table me-1"></i>桌號：{{ table_number }}
        </span>
    </li>
    {% endif %}
{% endblock %}

{% block user_info %}
    <!-- 訪客模式：顯示購物車和桌號信息 -->
    {% if shop and table_number %}
    <a href="{{ url_for('guest.cart', shop_id=shop.id, table_number=table_number) }}" class="btn btn-outline-warning btn-sm me-2 position-relative">
        <i class="bi bi-cart3"></i> 購物車
        <span id="cartCount" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none;">
            0
        </span>
    </a>
    {% endif %}
    
    <span class="text-white-50 small">
        <i class="bi bi-person me-1"></i>訪客模式
    </span>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/store.css') }}">
{% endblock %}

{% block extra_js %}
<script>
// 訪客模式購物車功能（使用 localStorage）
function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('guestCart_{{ shop.id if shop else 0 }}_{{ table_number if table_number else "" }}') || '[]');
    const count = cart.length;
    const badge = $('#cartCount');
    
    if (count > 0) {
        badge.text(count).show();
    } else {
        badge.hide();
    }
}

// 登出按鈕（訪客模式不需要）
$(document).ready(function() {
    updateCartCount();
});
</script>
{% endblock %}

